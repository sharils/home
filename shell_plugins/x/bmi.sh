#!/usr/bin/env sh

[ -n "$SET_X" ] && set -x

bmi() {
  if [ $# -eq 0 ]; then
    # const toWeight = (height, bmi) => (bmi * height ** 2) / 10000;
    #
    # console.log("BMI  18.50  21.00  21.35  21.70  24.99");
    # for (let height = 140; height <= 200; height++) {
    #   console.log(
    #     "%s  %s  %s  %s  %s  %s",
    #     height,
    #     toWeight(height, 18.50).toFixed(2),
    #     toWeight(height, 21.00).toFixed(2),
    #     toWeight(height, 21.35).toFixed(2),
    #     toWeight(height, 21.70).toFixed(2),
    #     toWeight(height, 24.99).toFixed(2)
    #   );
    # }
    # console.log("BMI  18.50  21.00  21.35  21.70  24.99");
    cat <<'EOF'
BMI  18.50  21.00  21.35  21.70  24.99
140  36.26  41.16  41.85  42.53  48.98
141  36.78  41.75  42.45  43.14  49.68
142  37.30  42.34  43.05  43.76  50.39
143  37.83  42.94  43.66  44.37  51.10
144  38.36  43.55  44.27  45.00  51.82
145  38.90  44.15  44.89  45.62  52.54
146  39.43  44.76  45.51  46.26  53.27
147  39.98  45.38  46.14  46.89  54.00
148  40.52  46.00  46.77  47.53  54.74
149  41.07  46.62  47.40  48.18  55.48
150  41.63  47.25  48.04  48.83  56.23
151  42.18  47.88  48.68  49.48  56.98
152  42.74  48.52  49.33  50.14  57.74
153  43.31  49.16  49.98  50.80  58.50
154  43.87  49.80  50.63  51.46  59.27
155  44.45  50.45  51.29  52.13  60.04
156  45.02  51.11  51.96  52.81  60.82
157  45.60  51.76  52.63  53.49  61.60
158  46.18  52.42  53.30  54.17  62.39
159  46.77  53.09  53.97  54.86  63.18
160  47.36  53.76  54.66  55.55  63.97
161  47.95  54.43  55.34  56.25  64.78
162  48.55  55.11  56.03  56.95  65.58
163  49.15  55.79  56.72  57.65  66.40
164  49.76  56.48  57.42  58.36  67.21
165  50.37  57.17  58.13  59.08  68.04
166  50.98  57.87  58.83  59.80  68.86
167  51.59  58.57  59.54  60.52  69.69
168  52.21  59.27  60.26  61.25  70.53
169  52.84  59.98  60.98  61.98  71.37
170  53.47  60.69  61.70  62.71  72.22
171  54.10  61.41  62.43  63.45  73.07
172  54.73  62.13  63.16  64.20  73.93
173  55.37  62.85  63.90  64.95  74.79
174  56.01  63.58  64.64  65.70  75.66
175  56.66  64.31  65.38  66.46  76.53
176  57.31  65.05  66.13  67.22  77.41
177  57.96  65.79  66.89  67.98  78.29
178  58.62  66.54  67.65  68.75  79.18
179  59.28  67.29  68.41  69.53  80.07
180  59.94  68.04  69.17  70.31  80.97
181  60.61  68.80  69.94  71.09  81.87
182  61.28  69.56  70.72  71.88  82.78
183  61.95  70.33  71.50  72.67  83.69
184  62.63  71.10  72.28  73.47  84.61
185  63.32  71.87  73.07  74.27  85.53
186  64.00  72.65  73.86  75.07  86.46
187  64.69  73.43  74.66  75.88  87.39
188  65.39  74.22  75.46  76.70  88.32
189  66.08  75.01  76.26  77.51  89.27
190  66.78  75.81  77.07  78.34  90.21
191  67.49  76.61  77.89  79.16  91.17
192  68.20  77.41  78.70  79.99  92.12
193  68.91  78.22  79.53  80.83  93.09
194  69.63  79.04  80.35  81.67  94.05
195  70.35  79.85  81.18  82.51  95.02
196  71.07  80.67  82.02  83.36  96.00
197  71.80  81.50  82.86  84.22  96.98
198  72.53  82.33  83.70  85.07  97.97
199  73.26  83.16  84.55  85.93  98.96
200  74.00  84.00  85.40  86.80  99.96
BMI  18.50  21.00  21.35  21.70  24.99
EOF
    return $?
  fi

  if [ $1 -eq 21 ] && [ $# -eq 2 ]; then
    printf 'H: %s, W: %s–%s %s, BMI: %s' \
      "$2" \
      "$(bc --mathlib --expression="scale=2; 21*($2/100)^2")" \
      "$(bc --mathlib --expression="scale=2; 21.7*($2/100)^2")" \
      "$(bc --mathlib --expression="scale=2; 21.35*($2/100)^2")" \
      "$1"

  elif [ $1 -ne 21 ]; then
    cat <<'EOF'
Underweight (Severe thinness)    < 16.0
Underweight (Moderate thinness)  16.0 – 16.9
Underweight (Mild thinness)      17.0 – 18.4
Normal range                     18.5 – 24.9
Overweight (Pre-obese)           25.0 – 29.9
Obese (Class I)                  30.0 – 34.9
Obese (Class II)                 35.0 – 39.9
Obese (Class III)                ≥ 40.0
EOF
    echo
    printf 'H: %s, W: %s, BMI: %s (Normal 18.5 – 24.9)' "$1" "$2" "$(bc --mathlib --expression="scale=2; $2 / ($1 / 100)^2")"
  fi
}

bmi "$@"
